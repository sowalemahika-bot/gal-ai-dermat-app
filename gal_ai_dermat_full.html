<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gal.AI.dermat — BiLuma & Cetaphil (Mock)</title>
  <style>
    :root{
      --brand-navy:#003366;
      --brand-teal:#009999;
      --bg:#f5f9fb;
      --card:#ffffff;
      --muted:#eef6ff;
    }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--brand-navy)}
    header{background:var(--brand-navy);color:#fff;padding:28px 16px;text-align:center}
    header h1{margin:0;font-size:28px}
    header p{margin:6px 0 0;font-size:16px;opacity:.9}
    .container{max-width:980px;margin:24px auto;background:var(--card);padding:28px;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.08)}
    h2{color:var(--brand-teal);margin:0 0 12px}
    .upload-box{border:2px dashed var(--brand-teal);padding:28px;border-radius:12px;background:#f0fdfd;text-align:center}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .stack{display:flex;flex-direction:column;gap:12px}
    input[type=file]{margin:12px 0}
    button{background:var(--brand-teal);color:#fff;border:none;padding:12px 18px;border-radius:8px;cursor:pointer;font-weight:600}
    button.secondary{background:#fff;color:var(--brand-teal);border:2px solid var(--brand-teal)}
    button.linklike{background:transparent;border:0;color:var(--brand-teal);text-decoration:underline;padding:0;margin:0;cursor:pointer}
    button:hover{filter:brightness(.95)}
    .hidden{display:none}
    .section{margin-top:28px}
    .card{background:var(--muted);padding:14px;border-radius:10px}
    .pill{display:inline-block;background:var(--brand-teal);color:#fff;border-radius:999px;padding:4px 10px;font-size:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
    .product{border:1px solid #e8eef5;border-radius:12px;padding:12px;display:flex;gap:12px;align-items:center;background:#fff}
    .product img{width:120px;height:auto;border-radius:8px;object-fit:contain;background:#fff}
    .meter{height:10px;background:#e7edf6;border-radius:999px;overflow:hidden}
    .meter span{display:block;height:100%;background:var(--brand-teal)}
    .metric-line{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .metric-line strong{font-weight:700}
    .percent{font-weight:700}
    .footer{margin:24px 0 6px;text-align:center;font-size:12px;color:#3a4b66}
    @media (max-width:720px){.row{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <h1>Gal.AI.dermat</h1>
    <p>(Mock demo) — Scan → Skin Report → Suggested Products → 2‑Week Routine → Re‑scan</p>
  </header>

  <main class="container">
    <!-- Step 1: Upload -->
    <section class="section upload-box" aria-label="Upload selfie">
      <h2>Step 1: Upload Your Selfie</h2>
      <p>Tip: Use good lighting, remove glasses/makeup if possible, look straight at the camera.</p>
      <input id="file" type="file" accept="image/*" />
      <br />
      <button id="analyzeBtn">Analyze My Skin</button>
      <span id="daysLeft" class="pill hidden" aria-live="polite"></span>
    </section>

    <!-- Step 2: Report -->
    <section id="report" class="section hidden" aria-label="Skin report">
      <h2>Step 2: Your Skin Report</h2>
      <div class="row">
        <div class="stack">
          <div class="card">
            <div class="metric-line">
              <strong>Dark Spots</strong>
              <span id="pSpots" class="percent">—</span>
            </div>
            <div class="meter"><span id="mSpots" style="width:62%"></span></div>
            <div id="tSpots">Moderate</div>
          </div>
          <div class="card">
            <div class="metric-line">
              <strong>Texture</strong>
              <span id="pTexture" class="percent">—</span>
            </div>
            <div class="meter"><span id="mTexture" style="width:58%"></span></div>
            <div id="tTexture">Slight roughness</div>
          </div>
          <div class="card">
            <div class="metric-line">
              <strong>Fine Lines</strong>
              <span id="pLines" class="percent">—</span>
            </div>
            <div class="meter"><span id="mLines" style="width:40%"></span></div>
            <div id="tLines">Mild (under-eye)</div>
          </div>
          <div class="card">
            <div class="metric-line">
              <strong>Overall</strong>
              <span id="pOverall" class="percent">—</span>
            </div>
            <div class="meter"><span id="mOverall" style="width:70%"></span></div>
            <div id="tOverall">Good — continue protection & hydration</div>
          </div>
        </div>
        <div class="card">
          <canvas id="preview" width="420" height="320" aria-label="Uploaded image preview"></canvas>
        </div>
      </div>
    </section>

    <!-- Step 3: Suggested Products (EXACTLY 3: 2 BiLuma + 1 Cetaphil) -->
    <section id="products" class="section hidden" aria-label="Suggested products">
      <h2>Step 3: Suggested Products (Shop on Nykaa)</h2>
      <div class="grid">
        <!-- BiLuma #1: Day Cream -->
        <article class="product">
          <img src="https://www.biluma.co.in/sites/default/files/2022-07/day-cream-01.webp" alt="BiLuma Advance Day Cream jar">
          <div>
            <h3>BiLuma Advance Day Cream</h3>
            <p>Brightening day moisturiser; apply after cleansing (AM).</p>
            <a href="https://www.nykaa.com/biluma-advance-day-cream/p/7067797" target="_blank" rel="noopener">
              <button class="secondary">Buy on Nykaa</button>
            </a>
          </div>
        </article>

        <!-- BiLuma #2: Night Cream -->
        <article class="product">
          <img src="https://www.biluma.co.in/sites/default/files/2022-07/night-cream-01.webp" alt="BiLuma Advance Night Cream jar">
          <div>
            <h3>BiLuma Advance Night Cream</h3>
            <p>Overnight nourishment; apply on clean skin (PM).</p>
            <a href="https://www.nykaa.com/biluma-advance-night-cream/p/7067798" target="_blank" rel="noopener">
              <button class="secondary">Buy on Nykaa</button>
            </a>
          </div>
        </article>

        <!-- Cetaphil: Sun SPF 50+ Light Gel (embedded image) -->
        <article class="product">
          <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAcFBQYFBA... (truncated for brevity) ... " alt="Cetaphil Sun SPF 50+ Light Gel">
          <div>
            <h3>Cetaphil Sun SPF 50+ Light Gel</h3>
            <p>Very high protection, lightweight gel formula; use as the last step of your AM routine.</p>
            <a href="https://www.nykaa.com/cetaphil-sun-spf-50-gel/p/930182" target="_blank" rel="noopener">
              <button class="secondary">Buy on Nykaa</button>
            </a>
          </div>
        </article>
      </div>
    </section>

    <!-- Step 4: 2-Week Routine & follow-up -->
    <section id="routine" class="section hidden" aria-label="2-week routine">
      <h2>Step 4: Your 2‑Week Skincare Routine</h2>
      <div class="card">
        <p><strong>Morning (Daily):</strong> Cleanse → <em>BiLuma Advance Day Cream</em> → <em>Cetaphil Sun SPF 50+ Light Gel</em> (broad‑spectrum)</p>
        <p><strong>Night (Daily):</strong> Cleanse → <em>BiLuma Advance Night Cream</em></p>
        <p><strong>Weekly (1×):</strong> Gentle exfoliation + deep hydration mask</p>
      </div>
    </section>

    <section id="followup" class="section hidden" aria-label="Follow-up scan">
      <h2>Step 5: Re‑Scan After 2 Weeks</h2>
      <div class="card">
        <p>Come back in <strong>14 days</strong> and upload a fresh selfie to get updated guidance for the next two weeks.</p>
        <div class="stack">
          <div class="row">
            <button id="reminderBtn">Set Calendar Reminder (ICS)</button>
            <button class="secondary" id="simulateReturn">Simulate “I came back after 14 days”</button>
          </div>
        </div>
      </div>
    </section>

    <p class="footer">© Mock demo for educational purposes. Not medical advice. Brand assets belong to their respective owners.</p>
  </main>

  <script>
    // Simple mock scoring + image preview
    const analyzeBtn = document.getElementById('analyzeBtn');
    const fileInput = document.getElementById('file');
    const report = document.getElementById('report');
    const routine = document.getElementById('routine');
    const products = document.getElementById('products');
    const followup = document.getElementById('followup');
    const canvas = document.getElementById('preview');
    const ctx = canvas?.getContext('2d');
    const daysLeftEl = document.getElementById('daysLeft');

    function setMeter(id, val, textId, text, percentId){
      document.getElementById(id).style.width = val + '%';
      document.getElementById(textId).textContent = text;
      document.getElementById(percentId).textContent = val + '%';
    }

    function drawPreview(file){
      if(!canvas || !ctx) return;
      const img = new Image();
      img.onload = () => {
        const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
        const w = img.width * scale, h = img.height * scale;
        const x = (canvas.width - w)/2, y = (canvas.height - h)/2;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.drawImage(img, x, y, w, h);
      };
      img.src = URL.createObjectURL(file);
    }

    function saveScanDate(){
      const now = new Date();
      localStorage.setItem('biluma_scan_at', now.toISOString());
    }

    function daysUntilNextScan(){
      const iso = localStorage.getItem('biluma_scan_at');
      if(!iso) return null;
      const last = new Date(iso);
      const next = new Date(last.getTime() + 14*24*60*60*1000);
      const diff = Math.ceil((next - new Date())/(24*60*60*1000));
      return diff;
    }

    function updateDaysLeftChip(){
      const diff = daysUntilNextScan();
      if(diff === null) { daysLeftEl.classList.add('hidden'); return; }
      if(diff > 0){
        daysLeftEl.textContent = diff + ' day' + (diff===1?'':'s') + ' to re‑scan';
        daysLeftEl.classList.remove('hidden');
      } else {
        daysLeftEl.textContent = 'It’s time to re‑scan!';
        daysLeftEl.classList.remove('hidden');
      }
    }

    function smoothScrollTo(el){
      el.scrollIntoView({behavior:'smooth', block:'start'});
    }

    function generateICS(){
      // 14 days from now, 9am local
      const now = new Date();
      const start = new Date(now.getFullYear(), now.getMonth(), now.getDate()+14, 9, 0, 0);
      const end = new Date(start.getTime() + 30*60*1000);
      function toICS(dt){
        const pad=n=>String(n).padStart(2,'0');
        return dt.getUTCFullYear()
          + pad(dt.getUTCMonth()+1)
          + pad(dt.getUTCDate()) + 'T'
          + pad(dt.getUTCHours())
          + pad(dt.getUTCMinutes())
          + pad(dt.getUTCSeconds()) + 'Z';
      }
      const ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Gal.AI.dermat Mock//EN
BEGIN:VEVENT
UID:${Date.now()}@gal-ai-dermat-mock
DTSTAMP:${toICS(new Date())}
DTSTART:${toICS(start)}
DTEND:${toICS(end)}
SUMMARY:Re-scan with Gal.AI.dermat (mock)
DESCRIPTION:Add a new selfie to get updated guidance.
END:VEVENT
END:VCALENDAR`;
      const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'gal-ai-dermat_rescan_14_days.ics';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    analyzeBtn.addEventListener('click', () => {
      const file = fileInput.files?.[0];
      if(file){ drawPreview(file); }
      // Mock scoring — randomize a bit for demo
      const rnd = () => Math.floor(40 + Math.random()*40);
      setMeter('mSpots', rnd(), 'tSpots', 'Moderate', 'pSpots');
      setMeter('mTexture', rnd(), 'tTexture', 'Slight roughness', 'pTexture');
      setMeter('mLines', rnd(), 'tLines', 'Mild (under‑eye)', 'pLines');
      setMeter('mOverall', rnd(), 'tOverall', 'Good — keep protecting & hydrating', 'pOverall');

      report.classList.remove('hidden');
      products.classList.remove('hidden');
      routine.classList.remove('hidden');
      followup.classList.remove('hidden');

      saveScanDate();
      updateDaysLeftChip();

      // Slow scroll: show report, then after ~4.5s go to products
      smoothScrollTo(report);
      setTimeout(()=> smoothScrollTo(products), 4500);
    });

    document.getElementById('reminderBtn').addEventListener('click', generateICS);
    document.getElementById('simulateReturn').addEventListener('click', () => {
      // pretend two weeks passed
      const now = new Date();
      const then = new Date(now.getTime() - 14*24*60*60*1000 - 60*1000);
      localStorage.setItem('biluma_scan_at', then.toISOString());
      updateDaysLeftChip();
      alert('Simulated return set. The chip now says it is time to re‑scan.');
    });

    // On load, show chip if a scan happened before
    updateDaysLeftChip();
  </script>
</body>
</html>